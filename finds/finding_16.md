## æ ‡é¢˜
`vesting::remove_shareholder` å‡½æ•°ç¼ºå°‘åˆ°æœŸå½’å±ç»“ç®—ï¼Œå…è®¸ admin æ’¤å›å¹¶çªƒå–è‚¡ä¸œå·²åˆ°æœŸçš„ä»£å¸ ğŸš¨

## ç±»å‹
Access Control / Inconsistent State Handling

## é£é™©ç­‰çº§
High

## ä½ç½®
- `sources/vesting.move`: `remove_shareholder` å‡½æ•° (L551-L613)

## å‘ç°ä¾æ®
1.  **åŠŸèƒ½ä¸æƒé™**: `remove_shareholder` æ˜¯ä¸€ä¸ªç‰¹æƒå‡½æ•°ï¼Œå…è®¸ `vesting_admin` ä» vesting åˆçº¦ä¸­ç§»é™¤ä»»ä½•ä¸€ä¸ªè‚¡ä¸œã€‚å…¶è®¾è®¡æ„å›¾å¯èƒ½æ˜¯ä¸ºäº†å¤„ç†ç¦»èŒå‘˜å·¥æˆ–è¿è§„å‚ä¸è€…ç­‰æƒ…å†µã€‚

2.  **é€»è¾‘ç¼ºé™·**: è¯¥å‡½æ•°åœ¨ç§»é™¤è‚¡ä¸œæ—¶ï¼Œç›´æ¥è¯»å–è‚¡ä¸œçš„ `left_amount`ï¼ˆå‰©ä½™å¾…é‡Šæ”¾æ€»é‡ï¼‰ï¼Œå¹¶å°†æ­¤æ•°é¢**å…¨éƒ¨**è½¬å›ç»™ admin æ§åˆ¶çš„ `withdrawal_address`ã€‚
    ```571:581:sources/vesting.move
    let shareholder_amount =
        simple_map::borrow(shareholders, &shareholder).left_amount;
    // ...
    primary_fungible_store::transfer(
        res_signer,
        dxlyn_metadata,
        res.withdrawal_address,
        shareholder_amount
    );
    ```
    `left_amount` åŒ…å«äº†**å·²åˆ°æœŸä½†æœªé¢†å–** (vested but unclaimed) çš„éƒ¨åˆ†å’Œ**æœªåˆ°æœŸ** (unvested) çš„éƒ¨åˆ†ã€‚è¯¥å‡½æ•°é”™è¯¯åœ°å°†è¿™ä¸¤éƒ¨åˆ†èµ„é‡‘å…¨éƒ¨æ’¤å›ã€‚

3.  **ç¼ºå°‘ç»“ç®—æ­¥éª¤**: ä¸æ­£ç¡®çš„ `terminate_vesting_contract` å‡½æ•° (L463) ä¸åŒï¼Œ`remove_shareholder` åœ¨æ‰§è¡Œæ’¤å›æ“ä½œå‰ï¼Œ**æ²¡æœ‰**è°ƒç”¨ `vest_individual` æˆ– `vesting_internal` æ¥ä¸ºè¯¥è‚¡ä¸œç»“ç®—å¹¶è½¬ç§»å…¶å·²ç»åˆ°æœŸçš„ä»£å¸ã€‚`terminate_vesting_contract` åœ¨ L469 æ­£ç¡®åœ°è°ƒç”¨äº† `vest(contract)` æ¥ç¡®ä¿æ‰€æœ‰å·²åˆ°æœŸçš„ä»½é¢åœ¨ç»ˆæ­¢å‰å¾—åˆ°åˆ†é…ã€‚

## æ”»å‡»è·¯å¾„ (S-L1 / Loss)
1.  **åˆå§‹çŠ¶æ€**: è‚¡ä¸œ Alice æœ‰ä¸€ä¸ª vesting åˆçº¦ï¼Œæ¯æœˆè§£é” 100 DXLYNã€‚åˆçº¦å·²è¿è¡Œ 6 ä¸ªæœˆï¼ŒAlice å·²æœ‰ 600 DXLYN åˆ°æœŸä½†å°šæœªé¢†å– (`claim`)ã€‚å¥¹çš„ `VestingRecord` ä¸­ `left_amount` ä»ç„¶æ˜¯å¥¹æœ€åˆçš„æ€»åˆ†é…é¢ã€‚

2.  **Admin æ“ä½œ**: `vesting_admin`ï¼ˆå¯èƒ½æ˜¯æ¶æ„çš„ï¼Œæˆ–å› ä¸šåŠ¡éœ€è¦ç§»é™¤ Aliceï¼‰è°ƒç”¨ `remove_shareholder(contract, Alice)`ã€‚

3.  **æ‰§è¡Œä¸å½±å“**:
    *   å‡½æ•°è¯»å– Alice çš„å…¨é¢ `left_amount`ã€‚
    *   å‡½æ•°å°† Alice çš„**å…¨éƒ¨**å‰©ä½™ä»£å¸ï¼ˆåŒ…æ‹¬å·²ç»åˆ°æœŸçš„ 600 DXLYN å’Œæœªæ¥æœªåˆ°æœŸçš„éƒ¨åˆ†ï¼‰è½¬è´¦ç»™ `withdrawal_address`ã€‚
    *   Alice è¢«ä»è‚¡ä¸œåˆ—è¡¨ä¸­ç§»é™¤ã€‚

4.  **ç»“æœ**: Alice æ°¸ä¹…æ€§åœ°æŸå¤±äº†å¥¹å·²ç»åˆæ³•æ‹¥æœ‰ï¼ˆVestedï¼‰çš„ 600 DXLYNã€‚è¿™æ„æˆäº†ç›´æ¥çš„èµ„äº§çªƒå–ï¼Œå› ä¸º vesting åˆçº¦çš„æ ¸å¿ƒæ‰¿è¯ºæ˜¯ï¼Œä¸€æ—¦ä»£å¸åˆ°æœŸï¼Œå…¶æ‰€æœ‰æƒå°±åº”å½’å±äºå—ç›Šäººã€‚

## å½±å“
- **èµ„äº§æŸå¤± (Loss)**: å¯¹è¢«ç§»é™¤çš„è‚¡ä¸œé€ æˆç›´æ¥çš„ã€ä¸å¯é€†çš„èµ„äº§æŸå¤±ã€‚Admin å¯ä»¥åˆ©ç”¨æ­¤å‡½æ•°çªƒå–ä»»ä½•è‚¡ä¸œå·²åˆ°æœŸä½†æœªé¢†å–çš„èµ„é‡‘ã€‚
- **è¿ååè®®æ ¸å¿ƒæ‰¿è¯º**: vesting åˆçº¦çš„æ ¹æœ¬ç›®çš„æ˜¯ä¿è¯åœ¨æ»¡è¶³æ—¶é—´æ¡ä»¶åå°†èµ„äº§è½¬ç§»ç»™å—ç›Šäººã€‚æ­¤æ¼æ´å®Œå…¨ç ´åäº†è¿™ä¸€ä¿¡ä»»åŸºç¡€ã€‚
- **ä¸è®¾è®¡æ„å›¾ä¸ç¬¦**: `terminate_vesting_contract` çš„æ­£ç¡®å®ç°è¡¨æ˜ï¼Œåè®®çš„è®¾è®¡æ„å›¾æ˜¯åœ¨ä»»ä½•ç»ˆæ­¢æ“ä½œå‰éƒ½åº”å…ˆç»“ç®—å·²åˆ°æœŸçš„ä»½é¢ã€‚`remove_shareholder` çš„å®ç°ä¸æ­¤ç›¸æ‚–ï¼Œåº”è¢«è§†ä¸ºä¸€ä¸ªä¸¥é‡çš„é€»è¾‘é—æ¼ã€‚

## æ ¹å› æ ‡ç­¾
`Missing Logic` / `Inconsistent State Handling` / `Access Control`

## çŠ¶æ€
Confirmed
