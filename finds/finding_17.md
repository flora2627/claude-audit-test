## æ ‡é¢˜
`voter::kill_gauge` æ°¸ä¹…å†»ç»“å¾…åˆ†é…å¥–åŠ±ï¼Œå¯¼è‡´ä¼šè®¡å¤±è¡¡ä¸èµ„äº§æŸå¤± ğŸš¨

## åˆ†ç±»
Freeze / Loss â€“ Inconsistent State Handling

## ä½ç½®
- `sources/voter.move`: `kill_gauge` å‡½æ•° (L663-L686)

## äºŒçº§æŒ‡æ ‡ä¸å½±å“
- **äºŒçº§æŒ‡æ ‡**: `voter.claimable: Table<address, u64>`ï¼Œæ­¤ä¸º `voter` åˆçº¦å¯¹å„ `gauge` åˆçº¦çš„è´Ÿå€ºè¡¨ã€‚
- **æ ¸å¿ƒæ–­è¨€**: `S-L3 (è·¨å£å¾„æ¬ç§»)` / `Invariant-Broken`ã€‚`voter` åˆçº¦çš„èµ„äº§ï¼ˆæŒæœ‰çš„ DXLYN ä½™é¢ï¼‰åº”ä¸å…¶è´Ÿå€ºï¼ˆ`sum(voter.claimable)`) ä¿æŒå¹³è¡¡ã€‚`kill_gauge` æ“ä½œç ´åäº†æ­¤æ’ç­‰å¼ã€‚
- **å½±å“é—¨æ§›**: `Freeze` / `Loss`ã€‚è¯¥æ“ä½œå¯¼è‡´ `voter` åˆçº¦ä¸­çš„éƒ¨åˆ† DXLYN èµ„äº§æ°¸ä¹…æ— æ³•è¢«åˆ†é…æˆ–æå–ï¼Œå¯¹åè®®æ„æˆèµ„äº§æŸå¤±ã€‚

## è¯¦ç»†è¯´æ˜

### è§¦å‘æ¡ä»¶ / è°ƒç”¨æ ˆ
1.  ä¸€ä¸ªæˆ–å¤šä¸ª `gauge` è·å¾—äº†æŠ•ç¥¨æƒé‡ï¼Œ`voter` åˆçº¦é€šè¿‡ `update_period()` â†’ `notify_reward_amount()` æµç¨‹ä¸ºå®ƒä»¬è®°å…¥äº†éé›¶çš„ `claimable` å¥–åŠ±ã€‚
2.  åœ¨è¿™äº›å¥–åŠ±é€šè¿‡ `distribute_*` å‡½æ•°è¢«å®é™…åˆ†å‘åˆ° `gauge` åˆçº¦ä¹‹å‰ï¼Œæ²»ç†æ–¹ (`governance`) å‡ºäºæ­£å¸¸ä¸šåŠ¡åŸå› ï¼ˆä¾‹å¦‚ï¼ŒæŸä¸ªæ± å­å·²å¼ƒç”¨ï¼‰è°ƒç”¨ `voter::kill_gauge(gauge_address)`ã€‚

### äºŒçº§å…¬å¼ä¸å£å¾„
- **èµ„äº§**: `voter` åˆçº¦è‡ªèº«çš„ DXLYN ä½™é¢ã€‚
- **è´Ÿå€º**: `sum_claimable = Î£ voter.claimable[g_i] for all i`
- **æ­£å¸¸çŠ¶æ€ä¸å˜é‡**: `voter.balance_of(DXLYN) â‰ˆ sum_claimable` (å¿½ç•¥å¾®å°ç²¾åº¦æŸå¤±)

### ç¼ºé™·åˆ†æ
`kill_gauge` å‡½æ•°åœ¨æ‰§è¡Œæ—¶ï¼Œå­˜åœ¨è‡´å‘½çš„é€»è¾‘é—æ¼ï¼š

```673:675:sources/voter.move
*is_alive = false;

table::upsert(&mut voter.claimable, gauge, 0);
```
- **L675 `table::upsert(&mut voter.claimable, gauge, 0);`**: è¿™ä¸€è¡Œä»£ç ç›´æ¥å°† `voter` åˆçº¦å¯¹è¯¥ `gauge` çš„è´Ÿå€ºï¼ˆå³å¾…åˆ†é…çš„å¥–åŠ±é‡‘é¢ï¼‰æŠ¹é™¤ï¼Œè®¾ç½®ä¸º `0`ã€‚
- **é—æ¼æ­¥éª¤**: å‡½æ•°åœ¨æ¸…é›¶è´Ÿå€ºåï¼Œ**æ²¡æœ‰å¯¹ç›¸åº”çš„èµ„äº§è¿›è¡Œä»»ä½•å¤„ç†**ã€‚è¿™ç¬”æœ¬åº”åˆ†é…ç»™ `gauge` çš„ DXLYN ä»£å¸ä»ç„¶ç•™åœ¨ `voter` åˆçº¦çš„ä½™é¢ä¸­ã€‚
- **çŠ¶æ€ä¸ä¸€è‡´**: è¯¥æ“ä½œå¯¼è‡´ `voter` åˆçº¦çš„èµ„äº§è´Ÿå€ºè¡¨ç«‹åˆ»å¤±è¡¡ï¼š`voter.balance_of(DXLYN) > sum_claimable`ã€‚å·®é¢æ­£å¥½ç­‰äºè¢«æŠ¹æ‰çš„ `claimable` é‡‘é¢ã€‚

### è¯æ® (P1-P3)
-   **äº¤æ˜“åºåˆ— (P1)**:
    1.  `voter::update_period()` è¢«è°ƒç”¨ï¼Œä¸º `gauge_A` è®°å…¥ `claimable[gauge_A] = 1,000,000`ã€‚æ­¤æ—¶ `voter` åˆçº¦æ”¶åˆ° 1,000,000 DXLYNã€‚
    2.  `governance` è°ƒç”¨ `voter::kill_gauge(gauge_A)`ã€‚
    3.  **ç»“æœ**: `claimable[gauge_A]` å˜ä¸º `0`ï¼Œä½† `voter` åˆçº¦çš„ä½™é¢ä¸­ä»æœ‰é‚£ 1,000,000 DXLYNã€‚

-   **å˜é‡å‰å (P2)**:
    *   `voter.claimable[gauge_A]`: `1,000,000` â†’ `0`
    *   `voter.balance_of(DXLYN)`: `N + 1,000,000` â†’ `N + 1,000,000` (æœªå˜)
    *   `sum(voter.claimable)`: `S + 1,000,000` â†’ `S`
    *   **èµ„äº§è´Ÿå€ºå·®é¢**: `0` â†’ `1,000,000`

-   **å½±å“é‡åŒ– (P3)**:
    *   **å†»ç»“/æŸå¤±é‡‘é¢**: ç­‰äºåœ¨ `distribute` å‰è¢« `kill` çš„æ‰€æœ‰ `gauge` çš„ `claimable` æ€»é¢ã€‚è¿™å¯èƒ½ç´¯ç§¯åˆ°æ•°ç™¾ä¸‡ç”šè‡³æ›´å¤šçš„ä»£å¸ã€‚
    *   **æ°¸ä¹…æ€§**: `voter` åˆçº¦æ²¡æœ‰æä¾›ä»»ä½•å‡½æ•°æ¥æå–è¿™äº›æ— ä¸»èµ„é‡‘ï¼ˆä¾‹å¦‚ `sweep` æˆ– `recover` å‡½æ•°ï¼‰ã€‚å› æ­¤ï¼Œè¿™äº›èµ„é‡‘è¢«æ°¸ä¹…å†»ç»“ï¼Œæ„æˆäº†äº‹å®ä¸Šçš„åè®®èµ„äº§æŸå¤±ã€‚

### åˆ©ç”¨è‰å›¾
è¿™æ˜¯ä¸€ä¸ªéœ€è¦æ²»ç†æƒé™æ‰èƒ½è§¦å‘çš„åè®®é€»è¾‘ç¼ºé™·ï¼Œè€Œéå¤–éƒ¨æ”»å‡»ã€‚ä¸€ä¸ªæ­£å¸¸ä½†ä¸çŸ¥æƒ…çš„æ²»ç†æ“ä½œå³å¯è§¦å‘æ­¤æ¼æ´ã€‚

1.  **åœºæ™¯**: åè®®è¿è¡Œæ•°å‘¨åï¼Œå†³å®šä¸‹çº¿ä¸€ä¸ªæ—§çš„æµåŠ¨æ€§æ±  `LP_Pool_Old`ã€‚
2.  **æ­£å¸¸æ“ä½œ**:
    *   `voter` åˆçº¦æŒ‰è®¡åˆ’è¿è¡Œ `update_period()`ï¼Œä¸º `LP_Pool_Old` å¯¹åº”çš„ `gauge_old` åˆ†é…äº†å½“å‘¨çš„ `claimable` å¥–åŠ±ã€‚
    *   åœ¨ä»»ä½•äººè°ƒç”¨ `distribute_all()` ä¹‹å‰ï¼Œæ²»ç†æ–¹æ‰§è¡Œ `kill_gauge(gauge_old)` æ¥ä½¿å…¶å¤±æ•ˆã€‚
3.  **æŸå¤±å‘ç”Ÿ**: `gauge_old` çš„æ‰€æœ‰å¾…é¢†å–å¥–åŠ±è¢«æ¸…é›¶ï¼Œèµ„é‡‘è¢«æ°¸ä¹…å›°åœ¨ `voter` åˆçº¦ä¸­ã€‚æµåŠ¨æ€§æä¾›è€…å› æ­¤æŸå¤±äº†ä»–ä»¬åº”å¾—çš„å…¨éƒ¨å¥–åŠ±ã€‚

## æ ¹å› æ ‡ç­¾
-   `Inconsistent State Handling`
-   `Invariant-Broken`
-   `Missing Logic`

## çŠ¶æ€
Confirmed
